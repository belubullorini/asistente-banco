<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Asistente de Llamadas ‚Äì Banco Mundial</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background-color: #121212;
        color: #ffffff;
    }
    .card {
        background-color: #1e1e1e;
        border-radius: 12px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.5);
        padding: 20px;
        margin-bottom: 15px;
        line-height: 1.5;
        font-size: 16px;
        white-space: pre-wrap;
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.5s ease;
        border: 2px solid transparent;
    }
    .card.show { opacity: 1; transform: translateY(0); }
    .card.active { border-color: #0d6efd; background-color: #2a2a2a; }
    .titulo { font-size: 20px; font-weight: bold; margin-bottom: 12px; color: #ffffff; }
    button.option-btn {
        display: block; width: 100%; padding: 12px; margin: 6px 0; font-size: 16px;
        font-weight: bold; border: none; border-radius: 8px; cursor: pointer; transition: 0.3s;
    }
    button.option-btn:hover { opacity: 0.85; }
    .inicio { background-color: #0d6efd; color: #fff; }
    .responsable { background-color: #198754; color: #fff; }
    .no_responsable { background-color: #ffc107; color: #000; }
    .cierre { background-color: #6f42c1; color: #fff; }
    .back-btn { background-color: #dc3545; color: #fff; margin-top:10px; }
    .resumen { background-color: #2a2a2a; border: 2px solid #0d6efd; padding: 15px; margin-top: 20px; border-radius: 10px; }
    .copiar-btn { background-color: #0d6efd; color: #fff; padding: 10px; border: none; border-radius: 8px; cursor: pointer; margin-top:10px; font-weight:bold; }
    .copiar-btn:hover { opacity: 0.85; }
</style>
</head>
<body>

<h1>Asistente de Llamadas ‚Äì Banco Mundial</h1>
<div id="container"></div>
<div id="resumenContainer"></div>

<script>
const flujo = {
    inicio: { titulo: "Inicio de llamada", texto: "Buenos d√≠as/tardes, ¬øme comunico con la empresa [NOMBRE EMPRESA]?\nMi nombre es [TU NOMBRE] y le llamo en representaci√≥n del Banco Mundial.\nEstamos necesitando hablar con el responsable de la toma de decisiones de la empresa o gerente.\n¬øSe encontrar√° disponible?", opciones: [{texto:"1. Atiende la persona responsable", siguiente:"responsable"},{texto:"2. No es la persona responsable / no disponible", siguiente:"no_responsable"}]},
    responsable: { titulo:"Si atiende la persona responsable", texto:"Motivo del llamado:\nEl motivo de la llamada es coordinar una entrevista ‚Äîpresencial o por Zoom‚Äî en el d√≠a y horario que usted disponga.\n¬øEs usted la persona responsable a cargo?", opciones:[{texto:"1. Pregunta de qu√© se trata", siguiente:"responsable_detalle"},{texto:"2. No pregunta", siguiente:"responsable_email"}]},
    responsable_detalle: { titulo:"Detalles de la entrevista", texto:"Es en el marco del estudio internacional conocido como Haciendo Negocios, realizado por el Banco Mundial.\nEl objetivo es conocer las experiencias y desaf√≠os que enfrentan las compa√±√≠as, para identificar oportunidades de mejora y aportar informaci√≥n al dise√±o de pol√≠ticas p√∫blicas que fortalezcan la actividad empresarial.\nLa entrevista es breve.", opciones:[{texto:"Continuar", siguiente:"responsable_email"}]},
    responsable_email: { titulo:"Pedir email", texto:"Para enviarle la informaci√≥n oficial, ¬øme podr√≠a facilitar un correo electr√≥nico suyo?", opciones:[{texto:"1. Da el correo", siguiente:"responsable_cierre"},{texto:"2. No da correo / duda", siguiente:"responsable_duda"}]},
    responsable_cierre: { titulo:"Cierre agenda", texto:"Perfecto, en este momento le estoy enviando el mail con toda la informaci√≥n oficial y el aval del Banco Mundial.\nYa lo tiene en su bandeja, ¬øqu√© d√≠a y horario le resulta m√°s c√≥modo para agendar la entrevista? Puede ser presencial o v√≠a Zoom.\n(El objetivo es cerrar la agenda en ese momento).", opciones:[]},
    responsable_duda: { titulo:"Duda o negativa", texto:"Lo entiendo perfectamente. Le propongo que revise el correo y la informaci√≥n oficial, y ma√±ana lo volvemos a contactar para confirmar la fecha de la entrevista.", opciones:[]},
    no_responsable: { titulo:"Si NO es la persona responsable", texto:"Comprendo, ¬øser√≠a posible que por favor me transfiera la llamada directamente con la persona encargada de la toma de decisiones?", opciones:[{texto:"1. Puede transferir", siguiente:"transferencia"},{texto:"2. No puede transferir", siguiente:"no_responsable_contacto"}]},
    transferencia: { titulo:"Transferencia de llamada", texto:"Perfecto, transfiera la llamada directamente con la persona responsable.", opciones:[]},
    no_responsable_contacto: { titulo:"Pedir contacto", texto:"Si no puede transferir, ¬øpodr√≠a facilitarme el n√∫mero de tel√©fono de la persona responsable para contactarlo directamente?\nLa llamada es de gran importancia, ya que proviene directamente en nombre del Banco Mundial.", opciones:[{texto:"1. Da tel√©fono", siguiente:"contacto_telefono"},{texto:"2. No da tel√©fono, pedir email", siguiente:"contacto_email"}]},
    contacto_telefono: { titulo:"Contacto por tel√©fono", texto:"Genial, contactar√© directamente por tel√©fono.", opciones:[], guardar:{telefono:true}},
    contacto_email: { titulo:"Contacto por email", texto:"En ese caso, ¬øme podr√≠a facilitar el correo electr√≥nico de la persona encargada para enviarle de inmediato la informaci√≥n oficial del Banco Mundial?", opciones:[{texto:"1. Da correo", siguiente:"email_cierre"},{texto:"2. No da ning√∫n contacto", siguiente:"sin_contacto"}]},
    email_cierre: { titulo:"Email enviado", texto:"Perfecto, en este momento le estoy enviando el mail con toda la informaci√≥n oficial y el aval del Banco Mundial.\n¬øPodr√≠a comentarle que ya tiene la informaci√≥n en su bandeja y consultarle qu√© d√≠a y horario le resultar√≠a m√°s c√≥modo para la entrevista?\nMa√±ana lo estaremos llamando nuevamente para confirmar la agenda.", opciones:[]},
    sin_contacto: { titulo:"Sin contacto", texto:"No hay problema. Le agradecer√≠a si pudiera informarle que hemos llamado de parte del Banco Mundial para coordinar una entrevista.\nMa√±ana volveremos a comunicarnos para avanzar con la agenda.", opciones:[]},
    cierre: { titulo:"Cierre cordial", texto:"Muchas gracias por su tiempo y colaboraci√≥n. Que tenga un buen d√≠a.", opciones:[]}
};

let container = document.getElementById("container");
let resumenContainer = document.getElementById("resumenContainer");
let historial = [];
let datos = {telefono: null};

function mostrarSeccion(id, retroceder=false) {
    if(id === "cierre"){
        // Mostrar resumen en la p√°gina
        let resumenHtml = `<div class="resumen"><strong>‚úÖ Llamada finalizada.</strong><br>`;
        if(datos.telefono) resumenHtml += `üìû Tel√©fono obtenido: <span id="telNumber">${datos.telefono}</span><br>`;
        resumenHtml += `Ruta tomada: ${historial.join(" ‚Üí ")}</div>`;

        resumenContainer.innerHTML = resumenHtml;

        if(datos.telefono){
            const copiarBtn = document.createElement("button");
            copiarBtn.className = "copiar-btn";
            copiarBtn.innerText = "Copiar tel√©fono al portapapeles";
            copiarBtn.onclick = () => {
                navigator.clipboard.writeText(datos.telefono);
                alert("N√∫mero copiado al portapapeles");
            };
            resumenContainer.appendChild(copiarBtn);
        }

        setTimeout(() => {
            container.innerHTML = "";
            historial = [];
            datos = {telefono: null};
            mostrarSeccion("inicio");
        }, 500);
        return;
    }

    const nodo = flujo[id];
    const card = document.createElement("div");
    card.className = "card active";
    card.innerHTML = `<div class="titulo">${nodo.titulo}</div><p>${nodo.texto}</p>`;

    setTimeout(() => { card.classList.add("show"); }, 50);

    if(retroceder && container.firstChild){
        container.replaceChild(card, container.firstChild);
        historial.push(id);
    } else {
        container.innerHTML = "";
        container.appendChild(card);
        historial.push(id);
    }

    nodo.opciones.forEach(op => {
        const btn = document.createElement("button");
        btn.className = "option-btn " + (op.texto.includes("responsable") ? "responsable" : (op.texto.includes("no disponible") ? "no_responsable" : "inicio"));
